/**
 * Rehype plugin.
 *
 * @note PLEASE DO NOT EDIT THIS FILE!
 * @note This entire file will be updated automatically.
 * @note Instead of editing here, please review <https://github.com/clevercanyon/skeleton>.
 */

import { visit as unistVisit } from 'unist-util-visit';

/**
 * Modifies external anchors by adding `rel` attribute for improved SEO.
 */
export default (tree) => {
    unistVisit(tree, 'element', (node) => {
        if ('a' === node.tagName && /^(?:https?:)?\/\//iu.test(node.properties.href || '')) {
            node.properties.rel = ((node.properties.rel || '') + ' external nofollow').trim();
            node.properties.rel = [...new Set(node.properties.rel.split(/\s+/u))].join(' ');
        }
        return node;
    });
};
